<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>WCS.jl · WCS.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href><img class="logo" src="assets/logo.gif" alt="WCS.jl logo"/></a><h1>WCS.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li class="current"><a class="toctext" href>WCS.jl</a><ul class="internal"><li><a class="toctext" href="#Table-of-Contents-1">Table of Contents</a></li><li><a class="toctext" href="#Installation-1">Installation</a></li><li><a class="toctext" href="#Usage-1">Usage</a></li><li><a class="toctext" href="#API/Reference-1">API/Reference</a></li><li><a class="toctext" href="#Index-1">Index</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>WCS.jl</a></li></ul><a class="edit-page" href="https://github.com/JuliaAstro/WCS.jl/blob/master/docs/src/index.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>WCS.jl</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="WCS.jl-1" href="#WCS.jl-1">WCS.jl</a></h1><p>Astronomical <a href="http://www.atnf.csiro.au/people/mcalabre/WCS/">World Coordinate System</a> library for Julia. This package wraps  the WCSLIB C library. This is a tool made for users who are already familiar with WCS transformations. If you are not, please  reference the following manuscripts</p><ol><li><a href="http://www.atnf.csiro.au/people/mcalabre/WCS/wcs.pdf">Representation of world coordinates in FITS</a></li><li><a href="http://www.atnf.csiro.au/people/mcalabre/WCS/ccs.pdf">Representations of celestial coordinates in FITS</a></li><li><a href="http://www.atnf.csiro.au/people/mcalabre/WCS/scs.pdf">Representations of spectral coordinates in FITS</a></li><li><a href="http://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">Representations of distortions in FITS world coordinate systems</a></li></ol><h2><a class="nav-anchor" id="Table-of-Contents-1" href="#Table-of-Contents-1">Table of Contents</a></h2><ul><li><a href="#WCS.jl-1">WCS.jl</a></li><ul><li><a href="#Table-of-Contents-1">Table of Contents</a></li><li><a href="#Installation-1">Installation</a></li><li><a href="#Usage-1">Usage</a></li><li><a href="#API/Reference-1">API/Reference</a></li><li><a href="#Index-1">Index</a></li></ul></ul><h2><a class="nav-anchor" id="Installation-1" href="#Installation-1">Installation</a></h2><p>From the REPL, press <code>]</code> to enter Pkg mode</p><pre><code class="language-none">(v 1.2) pkg&gt; add WCS</code></pre><h2><a class="nav-anchor" id="Usage-1" href="#Usage-1">Usage</a></h2><p>Import the library</p><pre><code class="language-julia-repl">julia&gt; using WCS</code></pre><p>There are many ways to utilize WCS transformations. Let&#39;s make one for a 2-dimensional array (like an image) from scratch.</p><pre><code class="language-julia-repl">julia&gt; wcs = WCSTransform(2;
                          cdelt = [-0.066667, 0.066667],
                          ctype = [&quot;RA---AIR&quot;, &quot;DEC--AIR&quot;],
                          crpix = [-234.75, 8.3393],
                          crval = [0., -90],
                          pv    = [(2, 1, 45.0)])
WCSTransform(naxis=2)</code></pre><p>We can also create one from a FITS header if it contains the appropriate keywords</p><pre><code class="language-julia"># Or from a FITS header with appropriate keywords
julia&gt; wcs_array = WCS.from_header(header)

julia&gt; wcs = wcs_array[1]
</code></pre><p>Now we can do conversions between pixel and world coordinates. </p><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>that WCS transforms use pixel <code>(0, 0)</code> as the top-left corner (not 1-indexed!!!)</p></div></div><pre><code class="language-julia-repl"># convert pixel -&gt; world coordinates
julia&gt; pixcoords = [0.0  24.0  45.0;  # x coordinates
                    0.0  38.0  98.0]  # y coordinates
2×3 Array{Float64,2}:
 0.0  24.0  45.0
 0.0  38.0  98.0

julia&gt; worldcoords = pix_to_world(wcs, pixcoords)
2×3 Array{Float64,2}:
 267.965   276.539   287.771
 -73.7366  -71.9741  -69.6781
julia&gt; pixcoords = world_to_pix(wcs, worldcoords)
2×3 Array{Float64,2}:
  1.16529e-12  24.0  45.0
 -7.10543e-14  38.0  98.0
</code></pre><h2><a class="nav-anchor" id="API/Reference-1" href="#API/Reference-1">API/Reference</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="WCS.WCSTransform" href="#WCS.WCSTransform"><code>WCS.WCSTransform</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">WCSTransform(naxis; kwds...)</code></pre><p>Construct a WCS transformation with the given number of axes <code>naxis</code>. Keyword arguments can be passed to set various attributes of the transform. Specifying keyword arguments is equivalent to setting them after construction:</p><pre><code class="language-none">julia&gt; wcs = WCSTransform(2; crpix=[1000., 1000.])</code></pre><p>is equilvalent to:</p><pre><code class="language-none">julia&gt; wcs = WCSTransform(2)

julia&gt; wcs.crpix = [1000., 1000.]</code></pre><p><strong>Properties</strong></p><p>Below is the entire list of public properties for a <code>WCSTransform</code></p><table><tr><th style="text-align: right">Keyword</th><th style="text-align: left">Type</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: right">naxis</td><td style="text-align: left"><code>Int</code></td><td style="text-align: left">Number of dimensions</td></tr><tr><td style="text-align: right">crval</td><td style="text-align: left"><code>Vector{Float}[naxis]</code></td><td style="text-align: left">coordinate value at reference point</td></tr><tr><td style="text-align: right">crpix</td><td style="text-align: left"><code>Vector{Float}[naxis]</code></td><td style="text-align: left">array location of the reference point in pixels</td></tr><tr><td style="text-align: right">cdelt</td><td style="text-align: left"><code>Vector{Float}[naxis]</code></td><td style="text-align: left">coordinate increment at reference point</td></tr><tr><td style="text-align: right">crder</td><td style="text-align: left"><code>Vector{Float}[naxis]</code></td><td style="text-align: left">random error in coordinate</td></tr><tr><td style="text-align: right">csyer</td><td style="text-align: left"><code>Vector{Float}[naxis]</code></td><td style="text-align: left">systematic error in coordinate</td></tr><tr><td style="text-align: right">ctype</td><td style="text-align: left"><code>Vector{String}[naxis]</code></td><td style="text-align: left">axis type (8 characters)</td></tr><tr><td style="text-align: right">crota</td><td style="text-align: left"><code>Vector{Float}[naxis]</code></td><td style="text-align: left">rotation from stated coordinate type</td></tr><tr><td style="text-align: right">cunit</td><td style="text-align: left"><code>Vector{String}[naxis]</code></td><td style="text-align: left">units of axes</td></tr><tr><td style="text-align: right">cunit</td><td style="text-align: left"><code>Vector{String}[naxis]</code></td><td style="text-align: left">names of axes</td></tr><tr><td style="text-align: right">pc</td><td style="text-align: left"><code>Matrix{Float}[naxis, naxis]</code></td><td style="text-align: left">linear transformation matrix</td></tr><tr><td style="text-align: right">cd</td><td style="text-align: left"><code>Matrix{Float}[naxis, naxis]</code></td><td style="text-align: left">linear transformation matrix (with scale)</td></tr><tr><td style="text-align: right">equinox</td><td style="text-align: left"><code>Float</code></td><td style="text-align: left">the equinox associated with dynamical equatorial or ecliptic coordinate systems</td></tr><tr><td style="text-align: right">latpole</td><td style="text-align: left"><code>Float</code></td><td style="text-align: left">the native latitude of the celestial pole</td></tr><tr><td style="text-align: right">lonpole</td><td style="text-align: left"><code>Float</code></td><td style="text-align: left">the native longitude of the celestial pole</td></tr><tr><td style="text-align: right">mjdavg</td><td style="text-align: left"><code>Float</code></td><td style="text-align: left">Modified Julian Date corresponding to <code>DATE-AVG</code></td></tr><tr><td style="text-align: right">mjdobs</td><td style="text-align: left"><code>Float</code></td><td style="text-align: left">Modified Julian Date corresponding to <code>DATE-OBS</code></td></tr><tr><td style="text-align: right">restfrq</td><td style="text-align: left"><code>Float</code></td><td style="text-align: left">rest frequency (Hz)</td></tr><tr><td style="text-align: right">restwav</td><td style="text-align: left"><code>Float</code></td><td style="text-align: left">rest wavelength (m)</td></tr><tr><td style="text-align: right">velangl</td><td style="text-align: left"><code>Float</code></td><td style="text-align: left">velocity angle</td></tr><tr><td style="text-align: right">velosys</td><td style="text-align: left"><code>Float</code></td><td style="text-align: left">relative radial velocity</td></tr><tr><td style="text-align: right">zsource</td><td style="text-align: left"><code>Float</code></td><td style="text-align: left">the redshift of the source</td></tr><tr><td style="text-align: right">colnum</td><td style="text-align: left"><code>Int</code></td><td style="text-align: left">column of FITS binary table associated with this WCS</td></tr><tr><td style="text-align: right">dateavg</td><td style="text-align: left"><code>String</code></td><td style="text-align: left">representative mid-point of the date of observation</td></tr><tr><td style="text-align: right">dateobs</td><td style="text-align: left"><code>String</code></td><td style="text-align: left">start of the date of observation</td></tr><tr><td style="text-align: right">radesys</td><td style="text-align: left"><code>String</code></td><td style="text-align: left">the equatorial or ecliptic coordinate system type</td></tr><tr><td style="text-align: right">specsys</td><td style="text-align: left"><code>String</code></td><td style="text-align: left">spectral reference frame (standard of rest)</td></tr><tr><td style="text-align: right">ssysobs</td><td style="text-align: left"><code>String</code></td><td style="text-align: left">spectral reference frame</td></tr><tr><td style="text-align: right">ssyssrc</td><td style="text-align: left"><code>String</code></td><td style="text-align: left">spectral reference frame for redshift</td></tr><tr><td style="text-align: right">wcsname</td><td style="text-align: left"><code>String</code></td><td style="text-align: left">name of this coordinate representation</td></tr><tr><td style="text-align: right">obsgeo</td><td style="text-align: left"><code>Vector{Float}[3]</code> or <code>Vector{Float}[6]</code></td><td style="text-align: left">location of the observer in a standard terrestrial reference frame</td></tr><tr><td style="text-align: right">alt</td><td style="text-align: left"><code>String</code></td><td style="text-align: left">character code for alternate coordinate descriptions</td></tr></table></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAstro/WCS.jl/blob/787492f7163a453bb48c766abf492604f4bacf89/src/WCS.jl#L243-L300">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="WCS.pix_to_world!-Tuple{WCSTransform,Union{Array{Float64,1}, Array{Float64,2}},Union{Array{Float64,1}, Array{Float64,2}}}" href="#WCS.pix_to_world!-Tuple{WCSTransform,Union{Array{Float64,1}, Array{Float64,2}},Union{Array{Float64,1}, Array{Float64,2}}}"><code>WCS.pix_to_world!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">pix_to_world!(wcs, pixcoords, worldcoords[; stat=, imcoords=, phi=, theta=])</code></pre><p>Convert the array of pixel coordinates <code>pixcoords</code> to world coordinates according to the WCSTransform <code>wcs</code>, storing the result in the <code>worldcoords</code> and <code>stat</code> arrays. <code>pixcoords</code> should be a 2-d array where &quot;pixcoords[:, i]&quot; is the i-th set of coordinates, or a 1-d array representing a single set of coordinates. <code>worldcoords</code> must be the same size and type as <code>pixcoords</code>.</p><p>If given, the arrays <code>stat</code>, <code>imcoords</code>, <code>phi</code>, <code>theta</code> will be used to store intermediate results. Their sizes and types must all match <code>pixcoords</code>, except for <code>stat</code> which should be the same size but of type Cint (typically Int32).</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAstro/WCS.jl/blob/787492f7163a453bb48c766abf492604f4bacf89/src/WCS.jl#L672-L686">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="WCS.pix_to_world-Tuple{WCSTransform,Union{Array{Float64,1}, Array{Float64,2}}}" href="#WCS.pix_to_world-Tuple{WCSTransform,Union{Array{Float64,1}, Array{Float64,2}}}"><code>WCS.pix_to_world</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">pix_to_world(wcs, pixcoords)</code></pre><p>Convert the array of pixel coordinates <code>pixcoords</code> to world coordinates according to the WCSTransform <code>wcs</code>. <code>pixcoords</code> should be a 2-d array where &quot;pixcoords[:, i]&quot; is the i-th set of coordinates, or a 1-d array representing a single set of coordinates.</p><p>The return value is the same shape as <code>pixcoords</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAstro/WCS.jl/blob/787492f7163a453bb48c766abf492604f4bacf89/src/WCS.jl#L658-L667">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="WCS.world_to_pix!-Tuple{WCSTransform,Union{Array{Float64,1}, Array{Float64,2}},Union{Array{Float64,1}, Array{Float64,2}}}" href="#WCS.world_to_pix!-Tuple{WCSTransform,Union{Array{Float64,1}, Array{Float64,2}},Union{Array{Float64,1}, Array{Float64,2}}}"><code>WCS.world_to_pix!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">world_to_pix!(wcs, worldcoords, pixcoords[; stat=, phi=, theta=, imcoords=])</code></pre><p>Convert the array of pixel coordinates <code>worldcoords</code> to pixel coordinates according to the WCSTransform <code>wcs</code>, storing the result in the <code>pixcoords</code> array. <code>worldcoords</code> should be a 2-d array where &quot;worldcoords[:, i]&quot; is the i-th set of coordinates, or a 1-d array representing a single set of coordinates. <code>pixcoords</code> must be the same size and type as <code>worldcoords</code>.</p><p>If given, the arrays <code>stat</code>, <code>imcoords</code>, <code>phi</code>, <code>theta</code> will be used to store intermediate results. Their sizes and types must all match <code>worldcoords</code>, except for <code>stat</code> which should be the same size but of type Cint (typically Int32).</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAstro/WCS.jl/blob/787492f7163a453bb48c766abf492604f4bacf89/src/WCS.jl#L727-L741">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="WCS.world_to_pix-Tuple{WCSTransform,Union{Array{Float64,1}, Array{Float64,2}}}" href="#WCS.world_to_pix-Tuple{WCSTransform,Union{Array{Float64,1}, Array{Float64,2}}}"><code>WCS.world_to_pix</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">world_to_pix(wcs, worldcoords)</code></pre><p>Convert the array of world coordinates <code>worldcoords</code> to pixel coordinates according to the WCSTransform <code>wcs</code>. <code>worldcoords</code> is a 2-d array where &quot;worldcoords[:, i]&quot; is the i-th set of coordinates, or a 1-d array representing a single set of coordinates.</p><p>The return value is the same size as <code>worldcoords</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAstro/WCS.jl/blob/787492f7163a453bb48c766abf492604f4bacf89/src/WCS.jl#L713-L722">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="WCS.from_header-Tuple{String}" href="#WCS.from_header-Tuple{String}"><code>WCS.from_header</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">from_header(header[; relax=WCS.HDR_ALL, ctrl=0, ignore_rejected=false, table=false])</code></pre><p>Parse the FITS image header in the String <code>header</code>, returning a <code>Vector{WCSTransform}</code> giving all the transforms defined in the header. The <code>relax</code> determines the treatment of non-standard keywords. The default is to accept all known non-standard keywords. Use <code>relax=WCS.HDR_NONE</code> to ignore all non-standard keywords. Use, e.g., <code>relax=(WCS.HDR_RADECSYS &amp; WCS.HDR_CROTAia)</code> to only accept selected non-standard keywords.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAstro/WCS.jl/blob/787492f7163a453bb48c766abf492604f4bacf89/src/WCS.jl#L770-L780">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="WCS.obsfix-Tuple{Integer,WCSTransform}" href="#WCS.obsfix-Tuple{Integer,WCSTransform}"><code>WCS.obsfix</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">obsfix(ctrl::Integer, wcs::WCSTransform)</code></pre><p>Complete the <code>obsgeo</code> field <code>wcs</code> of observatory coordinates.  That is, if only the (x,y,z) Cartesian coordinate triplet or the (l,b,h) geodetic coordinate triplet are set, then it derives the other triplet from it. If both triplets are set, then it checks for consistency at the level of 1 metre.</p><p><strong>Parameters</strong></p><ul><li><code>ctrl</code>: flag that controls behaviour if one triplet is defined and the other is only partially defined:<ul><li>0: Reset only the undefined elements of an incomplete coordinate triplet.</li><li>1: Reset all elements of an incomplete triplet.</li><li>2: Don&#39;t make any changes, check for consistency only. Returns an error if either of the two triplets is incomplete.</li></ul></li><li><code>wcs</code>: Coordinate transformation parameters. Its <code>obsgeo</code> field may be changed.</li></ul><p><strong>Returns</strong></p><ul><li>-1: No change required (not an error).</li><li>0: Success.</li><li>1: Null wcsprm pointer passed.</li><li>5: Invalid parameter value.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAstro/WCS.jl/blob/787492f7163a453bb48c766abf492604f4bacf89/src/WCS.jl#L444-L468">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="WCS.to_header-Tuple{WCSTransform}" href="#WCS.to_header-Tuple{WCSTransform}"><code>WCS.to_header</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">to_header(wcs[; relax=WCS.HDR_NONE])</code></pre><p>Encode the WCSTransform <code>wcs</code> as a FITS header string. The <code>relax</code> keyword controls how non-standard extensions to the WCS standard are handled.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAstro/WCS.jl/blob/787492f7163a453bb48c766abf492604f4bacf89/src/WCS.jl#L837-L842">source</a></section><h2><a class="nav-anchor" id="Index-1" href="#Index-1">Index</a></h2><ul><li><a href="#WCS.WCSTransform"><code>WCS.WCSTransform</code></a></li><li><a href="#WCS.from_header-Tuple{String}"><code>WCS.from_header</code></a></li><li><a href="#WCS.obsfix-Tuple{Integer,WCSTransform}"><code>WCS.obsfix</code></a></li><li><a href="#WCS.pix_to_world-Tuple{WCSTransform,Union{Array{Float64,1}, Array{Float64,2}}}"><code>WCS.pix_to_world</code></a></li><li><a href="#WCS.pix_to_world!-Tuple{WCSTransform,Union{Array{Float64,1}, Array{Float64,2}},Union{Array{Float64,1}, Array{Float64,2}}}"><code>WCS.pix_to_world!</code></a></li><li><a href="#WCS.to_header-Tuple{WCSTransform}"><code>WCS.to_header</code></a></li><li><a href="#WCS.world_to_pix-Tuple{WCSTransform,Union{Array{Float64,1}, Array{Float64,2}}}"><code>WCS.world_to_pix</code></a></li><li><a href="#WCS.world_to_pix!-Tuple{WCSTransform,Union{Array{Float64,1}, Array{Float64,2}},Union{Array{Float64,1}, Array{Float64,2}}}"><code>WCS.world_to_pix!</code></a></li></ul><footer><hr/></footer></article></body></html>
