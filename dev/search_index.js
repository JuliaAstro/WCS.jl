var documenterSearchIndex = {"docs":
[{"location":"#WCS.jl","page":"Home","title":"WCS.jl","text":"(Image: Stable) (Image: Dev)\n\n(Image: CI) (Image: PkgEval) (Image: codecov) (Image: License)\n\nAstronomical World Coordinate System library for Julia. This package wraps the WCSLIB C library. This is a tool made for users who are already familiar with WCS transformations. If you are not, please reference the following manuscripts\n\nRepresentation of world coordinates in FITS\nRepresentations of celestial coordinates in FITS\nRepresentations of spectral coordinates in FITS\nRepresentations of distortions in FITS world coordinate systems","category":"section"},{"location":"#Installation","page":"Home","title":"Installation","text":"From the REPL, press ] to enter Pkg mode\n\npkg> add WCS","category":"section"},{"location":"#Usage","page":"Home","title":"Usage","text":"Import the library:\n\nThere are many ways to utilize WCS transformations. Let's make one for a 2-dimensional array (like an image) from scratch:\n\njulia> wcs = WCSTransform(2;\n           cdelt = [-0.066667, 0.066667],\n           ctype = [\"RA---AIR\", \"DEC--AIR\"],\n           crpix = [-234.75, 8.3393],\n           crval = [0., -90],\n           pv    = [(2, 1, 45.0)],\n       )\nWCSTransform(naxis=2, cdelt=[-0.066667, 0.066667], crval=[0.0, -90.0], crpix=[-234.75, 8.3393])\n\nWe can also create one directly from a header loaded from FITSIO.jl if it contains the appropriate keywords:\n\njulia> using FITSIO: read_header\n\njulia> using Downloads: download\n\njulia> header = (read_header ∘ download)(\"https://fits.gsfc.nasa.gov/nrao_data/samples/wcs/m82rad.fits\");\n\njulia> WCS.from_header(header; ignore_rejected = true)\n1-element Vector{WCSTransform}:\n WCSTransform(naxis=4, cdelt=[-0.0002247777738, 0.0002273333375, 5.0e7, 1.0], crval=[147.927100003, 69.9079999924, 1.49e9, 0.0], crpix=[0.0, 0.0, 0.0, 1.0])\n\ndetails: header file\njulia> typeof(header)\nFITSIO.FITSHeader\n\njulia> header\nSIMPLE  =                    T\nBITPIX  =                   16\nNAXIS   =                    4\nNAXIS1  =                  558\nNAXIS2  =                  262\nNAXIS3  =                    1\nNAXIS4  =                    1\nEXTEND  =                    T / Tables following main image\nBLOCKED =                    T / Tape may be blocked\nOBJECT  = 'U05322  '\nTELESCOP= 'VLA     '\nINSTRUME= 'VLA     '\nOBSERVER= 'AC243   '\nDATE-OBS= '06/02/89'\nDATE-MAP= '13/09/94'\nBSCALE  =     1.95069823037e-6 / REAL = TAPE * BSCALE + BZERO\nBZERO   =      0.0548100471497\nBUNIT   = 'JY/BEAM '\nEPOCH   =               1950.0 / EPOCH OF RA DEC\nBLANK   =               -32768 / Blanked pixel tape value\nVELREF  =                    3 / >256 RADIO, 1 LSR 2 HEL 3 OBS\nALTRVAL =             100000.0 / ALTENATE FREQ/VEL REF VALUE\nALTRPIX =                  1.0 / ALTENATE FREQ/VEL REF PIXEL\nYSHIFT  =      1.421085472e-14 / NET SHIFT OF PHASE CENTER INY\nDATAMAX =         0.1187149212 / MAX PIXEL VALUE\nDATAMIN =      -0.009094826877 / MIN PIXEL VALUE\nCTYPE1  = 'RA---ARC'\nCRVAL1  =        147.927100003\nCDELT1  =     -0.0002247777738\nCRPIX1  =                301.5\nCROTA1  =                  0.0\nCTYPE2  = 'DEC--ARC'\nCRVAL2  =        69.9079999924\nCDELT2  =      0.0002273333375\nCRPIX2  =                 95.5\nCROTA2  =          24.26000023\nCTYPE3  = 'FREQ    '\nCRVAL3  =               1.49e9\nCDELT3  =                5.0e7\nCRPIX3  =                  1.0\nCROTA3  =                  0.0\nCTYPE4  = 'STOKES  '\nCRVAL4  =                  1.0\nCDELT4  =                  1.0\nCRPIX4  =                  1.0\nCROTA4  =                  0.0\nHISTORY --------------------------------------------------------------------\nHISTORY /Begin \"HISTORY\" information found in fits tape header by IMLOD\nHISTORY BLOCKED =                    T /Tape may be blocked\nHISTORY --------------------------------------------------------------------\nHISTORY /Begin \"HISTORY\" information found in fits tape header by IMLOD\nHISTORY BLOCKED =                    T /Tape may be blocked\nHISTORY AIPS   IMNAME='NGC3034     ' IMCLASS='SUBIM ' IMSEQ=   1     /\nHISTORY AIPS   USERNO=  135            /\nHISTORY AIPS   CLEAN BMAJ=  5.0000E-04 BMIN=  5.0000E-04 BPA=   0.00\nHISTORY AIPS   CLEAN NITER=     2000 PRODUCT=1   / NORMAL\nHISTORY /END FITS tape header \"HISTORY\" information\nHISTORY --------------------------------------------------------------------\nHISTORY IMLOD OUTNAME ='\nHISTORY IMLOD OUTSEQ =    0     INTAPE = 1     OUTDISK= 2\nHISTORY IMLOD INFILE = 'FITS2:NGC3034.A                                 '\nHISTORY IMLOD RELEASE = '15JUL94'\nHISTORY SUBIM RELEASE ='15JUL94 '  /********* Start 25-MAR-1994   09:37:01\nHISTORY SUBIM INNAME='M82 in radio'   INCLASS='SUBIM '\nHISTORY SUBIM INSEQ=    1   INDISK=  2\nHISTORY SUBIM INTYPE ='MA'      USERID=  103\nHISTORY SUBIM OUTNAME='M82 in radio'   OUTCLASS='SUBIM '\nHISTORY SUBIM OUTSEQ=    2   OUTDISK=  2\nHISTORY SUBIM BLC    =    1,    1,    1,    1,    1,    1,    1\nHISTORY SUBIM TRC    =  256,  256,    1,    1,    1,    1,    1\nHISTORY SUBIM XINC   =    2      YINC =    2\nHISTORY SUBIM OPCODE = 'AVE '\nHISTORY HGEOM RELEASE ='15JUL94 '  /********* Start 25-MAR-1994   09:37:24\nHISTORY HGEOM INNAME='M82 in radio'   INCLASS='SUBIM '\nHISTORY HGEOM INSEQ=    2   INDISK=  2\nHISTORY HGEOM IN2NAME='M82 in blue '   IN2CLASS='SUBIM '\nHISTORY HGEOM IN2SEQ=    1   IN2DISK=  2\nHISTORY HGEOM OUTNAME='M82 in radio'   OUTCLASS='      '\nHISTORY HGEOM OUTSEQ=    1   OUTDISK=  2\nHISTORY HGEOM BLC =    1,    1,   1,   1,   1,   1,   1\nHISTORY HGEOM TRC =  128,  128,   1,   1,   1,   1,   1\nHISTORY HGEOM IMSIZE =  558,  263          / Output image size\nHISTORY HGEOM  / Interpolation order used was BiCubic\nHISTORY HGEOM  / Indeterminate pixels filled with magic values\nHISTORY HGEOM  /     131164 Pixels blanked due to memory limits or geometry\nHISTORY HGEOM  /          0 Pixels blanked due to input blanked pixels\nHISTORY AIPS   IMNAME='M82 in radio' IMCLASS='HGEOM ' IMSEQ=   1     /\nHISTORY AIPS   USERNO=  103            /\nHISTORY AIPS   CLEAN BMAJ=  5.0000E-04 BMIN=  5.0000E-04 BPA=   0.00\nHISTORY AIPS   CLEAN NITER=     2000 PRODUCT=1   / NORMAL\nHISTORY /END FITS tape header \"HISTORY\" information\nHISTORY --------------------------------------------------------------------\nHISTORY IMLOD OUTNAME ='\nHISTORY IMLOD OUTSEQ =    0     INTAPE = 1     OUTDISK= 4\nHISTORY IMLOD INFILE = 'FITS2:M82RADIO.FITS                             '\nHISTORY IMLOD RELEASE = '15JAN95'\nHISTORY SUBIM RELEASE ='15JAN95 '  /********* Start 13-SEP-1994   13:00:09\nHISTORY SUBIM INNAME='M82 in radio'   INCLASS='HGEOM '\nHISTORY SUBIM INSEQ=    1   INDISK=  4\nHISTORY SUBIM INTYPE ='MA'      USERID=  103\nHISTORY SUBIM OUTNAME='M82         '   OUTCLASS='Radio '\nHISTORY SUBIM OUTSEQ=    3   OUTDISK=  4\nHISTORY SUBIM BLC    =    1,    1,    1,    1,    1,    1,    1\nHISTORY SUBIM TRC    =  558,  262,    1,    1,    1,    1,    1\nHISTORY SUBIM XINC   =    1      YINC =    1\nHISTORY SUBIM OPCODE = '    '\nORIGIN  = 'AIPSGorilla (NRAOCV IPX) 15JAN95'\nDATE    = '13/09/94'           / File written on dd/mm/yy\nHISTORY AIPS   IMNAME='M82         ' IMCLASS='Radio ' IMSEQ=   3     /\nHISTORY AIPS   USERNO=  103            /\nHISTORY AIPS   CLEAN BMAJ=  5.0000E-04 BMIN=  5.0000E-04 BPA=   0.00\nHISTORY AIPS   CLEAN NITER=     2000 PRODUCT=1   / NORMAL\n\nNow we can do conversions between pixel and world coordinates.\n\nnote: Note\nWCS transforms use pixel (0, 0) as the top-left corner (not 1-indexed!!)\n\njulia> pixcoords = [0.0  24.0  45.0;  # x coordinates\n                    0.0  38.0  98.0]  # y coordinates\n2×3 Matrix{Float64}:\n 0.0  24.0  45.0\n 0.0  38.0  98.0\n\njulia> worldcoords = pix_to_world(wcs, pixcoords)\n2×3 Matrix{Float64}:\n 267.965   276.539   287.771\n -73.7366  -71.9741  -69.6781\n\njulia> pixcoords = world_to_pix(wcs, worldcoords)\n2×3 Matrix{Float64}:\n  1.16529e-12  24.0  45.0\n -7.10543e-14  38.0  98.0","category":"section"},{"location":"#API/Reference","page":"Home","title":"API/Reference","text":"","category":"section"},{"location":"#Index","page":"Home","title":"Index","text":"","category":"section"},{"location":"#WCS.WCSTransform","page":"Home","title":"WCS.WCSTransform","text":"WCSTransform(naxis; kwds...)\n\nConstruct a WCS transformation with the given number of axes naxis. Keyword arguments can be passed to set various attributes of the transform. Specifying keyword arguments is equivalent to setting them after construction:\n\njulia> wcs = WCSTransform(2; crpix=[1000., 1000.])\nWCSTransform(naxis=2, cdelt=[1.0, 1.0], crval=[0.0, 0.0], crpix=[1000.0, 1000.0])\n\nis equivalent to:\n\njulia> wcs = WCSTransform(2)\nWCSTransform(naxis=2, cdelt=[1.0, 1.0], crval=[0.0, 0.0], crpix=[0.0, 0.0])\n\njulia> wcs.crpix = [1000., 1000.];\n\njulia> wcs\nWCSTransform(naxis=2, cdelt=[1.0, 1.0], crval=[0.0, 0.0], crpix=[1000.0, 1000.0])\n\nProperties\n\nBelow is the entire list of public properties for a WCSTransform\n\nKeyword Type Description\nnaxis Int32 Number of dimensions\ncrval Vector{Float64} (length naxis) coordinate value at reference point\ncrpix Vector{Float64} (length naxis) array location of the reference point in pixels\ncdelt Vector{Float64} (length naxis) coordinate increment at reference point\ncrder Vector{Float64} (length naxis) random error in coordinate\ncsyer Vector{Float64} (length naxis) systematic error in coordinate\nctype Vector{String} (length naxis) axis type (8 characters)\ncrota Vector{Float64} (length naxis) rotation from stated coordinate type\ncunit Vector{String} (length naxis) units of axes\ncunit Vector{String} (length naxis) names of axes\npc Matrix{Float64} (size naxis × naxis) linear transformation matrix\ncd Matrix{Float64} (size naxis × naxis) linear transformation matrix (with scale)\nequinox Float64 the equinox associated with dynamical equatorial or ecliptic coordinate systems\nlatpole Float64 the native latitude of the celestial pole\nlonpole Float64 the native longitude of the celestial pole\nmjdavg Float64 Modified Julian Date corresponding to DATE-AVG\nmjdobs Float64 Modified Julian Date corresponding to DATE-OBS\nrestfrq Float64 rest frequency (Hz)\nrestwav Float64 rest wavelength (m)\nvelangl Float64 velocity angle\nvelosys Float64 relative radial velocity\nzsource Float64 the redshift of the source\ncolnum Int32 column of FITS binary table associated with this WCS\ndateavg String representative mid-point of the date of observation\ndateobs String start of the date of observation\nradesys String the equatorial or ecliptic coordinate system type\nspecsys String spectral reference frame (standard of rest)\nssysobs String spectral reference frame\nssyssrc String spectral reference frame for redshift\nwcsname String name of this coordinate representation\nobsgeo Vector{Float64} (length 3 or 6) location of the observer in a standard terrestrial reference frame\nalt String character code for alternate coordinate descriptions\n\n\n\n\n\n","category":"type"},{"location":"#WCS.from_header-Tuple{String}","page":"Home","title":"WCS.from_header","text":"from_header(header[; relax=WCS.HDR_ALL, ctrl=0, ignore_rejected=false, table=false])\n\nParse the FITS image header in the String header, returning a Vector{WCSTransform} giving all the transforms defined in the header. The relax determines the treatment of non-standard keywords. The default is to accept all known non-standard keywords. Use relax=WCS.HDR_NONE to ignore all non-standard keywords. Use, e.g., relax=(WCS.HDR_RADECSYS & WCS.HDR_CROTAia) to only accept selected non-standard keywords.\n\n\n\n\n\n","category":"method"},{"location":"#WCS.obsfix-Tuple{Integer, WCSTransform}","page":"Home","title":"WCS.obsfix","text":"obsfix(ctrl::Integer, wcs::WCSTransform)\n\nComplete the obsgeo field wcs of observatory coordinates.  That is, if only the (x,y,z) Cartesian coordinate triplet or the (l,b,h) geodetic coordinate triplet are set, then it derives the other triplet from it. If both triplets are set, then it checks for consistency at the level of 1 metre.\n\nParameters\n\nctrl: flag that controls behaviour if one triplet is defined and the other is only partially defined:\n0: Reset only the undefined elements of an incomplete coordinate triplet.\n1: Reset all elements of an incomplete triplet.\n2: Don't make any changes, check for consistency only. Returns an error if either of the two triplets is incomplete.\nwcs: Coordinate transformation parameters. Its obsgeo field may be changed.\n\nReturns\n\n-1: No change required (not an error).\n0: Success.\n1: Null wcsprm pointer passed.\n5: Invalid parameter value.\n\n\n\n\n\n","category":"method"},{"location":"#WCS.pix_to_world!-Tuple{WCSTransform, Any, Any}","page":"Home","title":"WCS.pix_to_world!","text":"pix_to_world!(wcs, pixcoords, worldcoords[; stat, imcoords, phi, theta])\n\nConvert the array of pixel coordinates pixcoords to world coordinates according to the WCSTransform wcs, storing the result in the worldcoords and stat arrays. pixcoords should be a 2-d array where pixcoords[:, i] is the i-th set of coordinates, or a 1-d array representing a single set of coordinates. worldcoords must be the same size and type as pixcoords.\n\nIf given, the arrays stat, imcoords, phi, theta will be used to store intermediate results. Their sizes and types must all match pixcoords, except for stat which should be the same size but of type Cint (typically Int32).\n\n\n\n\n\n","category":"method"},{"location":"#WCS.pix_to_world-Tuple{WCSTransform, VecOrMat{Float64}}","page":"Home","title":"WCS.pix_to_world","text":"pix_to_world(wcs, pixcoords)\n\nConvert the array of pixel coordinates pixcoords to world coordinates according to the WCSTransform wcs. pixcoords should be a 2-d array where pixcoords[:, i] is the i-th set of coordinates, or a 1-d array representing a single set of coordinates.\n\nThe return value is the same shape as pixcoords.\n\n\n\n\n\n","category":"method"},{"location":"#WCS.to_header-Tuple{WCSTransform}","page":"Home","title":"WCS.to_header","text":"to_header(wcs[; relax=WCS.HDR_NONE])\n\nEncode the WCSTransform wcs as a FITS header string. The relax keyword controls how non-standard extensions to the WCS standard are handled.\n\n\n\n\n\n","category":"method"},{"location":"#WCS.world_to_pix!-Tuple{WCSTransform, Any, Any}","page":"Home","title":"WCS.world_to_pix!","text":"world_to_pix!(wcs, worldcoords, pixcoords[; stat, phi, theta, imcoords])\n\nConvert the array of pixel coordinates worldcoords to pixel coordinates according to the WCSTransform wcs, storing the result in the pixcoords array. worldcoords should be a 2-d array where worldcoords[:, i] is the i-th set of coordinates, or a 1-d array representing a single set of coordinates. pixcoords must be the same size and type as worldcoords.\n\nIf given, the arrays stat, imcoords, phi, theta will be used to store intermediate results. Their sizes and types must all match worldcoords, except for stat which should be the same size but of type Cint (typically Int32).\n\n\n\n\n\n","category":"method"},{"location":"#WCS.world_to_pix-Tuple{WCSTransform, VecOrMat{Float64}}","page":"Home","title":"WCS.world_to_pix","text":"world_to_pix(wcs, worldcoords)\n\nConvert the array of world coordinates worldcoords to pixel coordinates according to the WCSTransform wcs. worldcoords is a 2-d array where worldcoords[:, i] is the i-th set of coordinates, or a 1-d array representing a single set of coordinates.\n\nThe return value is the same size as worldcoords.\n\n\n\n\n\n","category":"method"}]
}
